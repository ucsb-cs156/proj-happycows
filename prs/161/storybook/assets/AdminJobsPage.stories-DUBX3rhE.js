import{j as e}from"./jsx-runtime-BC85tlZo.js";import{r as i}from"./iframe-BTuJcAs9.js";import{B as Z}from"./BasicLayout-BZRsvyjz.js";import{P as ee}from"./PagedJobsTable-BN5hcxIq.js";import{u as w,c as y}from"./ThemeProvider-BdPtjSDM.js";import{C as oe,e as te}from"./AppNavbar-CeS10Hsd.js";import{u as A,F as c}from"./index.esm-CSIWFIrx.js";import{B as T}from"./Button-BDV_ecRq.js";import{a as M,u as f,y as S}from"./useBackend-CbiZWCPX.js";import"./preload-helper-D9Z9MdNV.js";import"./Footer-CkaGO9C0.js";import"./Container-DxFu-v-g.js";import"./currentUser-Beivyx2b.js";import"./index-3Z6SaR-l.js";import"./index-BB7RSFYR.js";import"./OurTable-DtSV993S.js";import"./Table-C9FVjeDE.js";import"./Anchor-BzGJqbxn.js";import"./index-BsV8Hyj2.js";import"./index-CRxGUhT0.js";import"./index-UoXrbRkj.js";import"./AbstractModalHeader-Dk09ggGT.js";import"./index-BFtBtmCj.js";import"./divWithClassName-BgyEq38x.js";import"./CardHeaderContext-COkk7u5z.js";import"./warning-0rzsTxeY.js";import"./Col-C_aqFeIP.js";function B(t,o){return Array.isArray(t)?t.includes(o):t===o}const N=i.createContext({});N.displayName="AccordionContext";const P=i.forwardRef(({as:t="div",bsPrefix:o,className:s,children:m,eventKey:n,...a},l)=>{const{activeEventKey:d}=i.useContext(N);return o=w(o,"accordion-collapse"),e.jsx(oe,{ref:l,in:B(d,n),...a,className:y(s,o),children:e.jsx(t,{children:i.Children.only(m)})})});P.displayName="AccordionCollapse";const H=i.createContext({eventKey:""});H.displayName="AccordionItemContext";const _=i.forwardRef(({as:t="div",bsPrefix:o,className:s,onEnter:m,onEntering:n,onEntered:a,onExit:l,onExiting:d,onExited:u,...p},h)=>{o=w(o,"accordion-body");const{eventKey:b}=i.useContext(H);return e.jsx(P,{eventKey:b,onEnter:m,onEntering:n,onEntered:a,onExit:l,onExiting:d,onExited:u,children:e.jsx(t,{ref:h,...p,className:y(s,o)})})});_.displayName="AccordionBody";function se(t,o){const{activeEventKey:s,onSelect:m,alwaysOpen:n}=i.useContext(N);return a=>{let l=t===s?null:t;n&&(Array.isArray(s)?s.includes(t)?l=s.filter(d=>d!==t):l=[...s,t]:l=[t]),m?.(l,a),o?.(a)}}const R=i.forwardRef(({as:t="button",bsPrefix:o,className:s,onClick:m,...n},a)=>{o=w(o,"accordion-button");const{eventKey:l}=i.useContext(H),d=se(l,m),{activeEventKey:u}=i.useContext(N);return t==="button"&&(n.type="button"),e.jsx(t,{ref:a,onClick:d,...n,"aria-expanded":Array.isArray(u)?u.includes(l):l===u,className:y(s,o,!B(u,l)&&"collapsed")})});R.displayName="AccordionButton";const U=i.forwardRef(({as:t="h2","aria-controls":o,bsPrefix:s,className:m,children:n,onClick:a,...l},d)=>(s=w(s,"accordion-header"),e.jsx(t,{ref:d,...l,className:y(m,s),children:e.jsx(R,{onClick:a,"aria-controls":o,children:n})})));U.displayName="AccordionHeader";const O=i.forwardRef(({as:t="div",bsPrefix:o,className:s,eventKey:m,...n},a)=>{o=w(o,"accordion-item");const l=i.useMemo(()=>({eventKey:m}),[m]);return e.jsx(H.Provider,{value:l,children:e.jsx(t,{ref:a,...n,className:y(s,o)})})});O.displayName="AccordionItem";const E=i.forwardRef((t,o)=>{const{as:s="div",activeKey:m,bsPrefix:n,className:a,onSelect:l,flush:d,alwaysOpen:u,...p}=te(t,{activeKey:"onSelect"}),h=w(n,"accordion"),b=i.useMemo(()=>({activeEventKey:m,onSelect:l,alwaysOpen:u}),[m,l,u]);return e.jsx(N.Provider,{value:b,children:e.jsx(s,{ref:o,...p,className:y(a,h,d&&`${h}-flush`)})})});E.displayName="Accordion";const J=Object.assign(E,{Button:R,Collapse:P,Item:O,Header:U,Body:_});function q({submitAction:t}){const o={fail:!1,sleepMs:1e3},{register:s,formState:{errors:m},handleSubmit:n}=A({defaultValues:o}),a="TestJobForm";return e.jsxs(c,{onSubmit:n(t),children:[e.jsxs(c.Group,{className:"mb-3",children:[e.jsx(c.Label,{htmlFor:"fail",children:"Fail? (if checked, job will fail, to test error handling)"}),e.jsx(c.Check,{"data-testid":`${a}-fail`,type:"checkbox",id:"fail",...s("fail")})]}),e.jsxs(c.Group,{className:"mb-3",children:[e.jsx(c.Label,{htmlFor:"sleepMs",children:"Sleep (milliseconds)"}),e.jsx(c.Control,{id:"sleepMs","data-testid":`${a}-sleepMs`,type:"number",step:"100",isInvalid:!!m.sleepMs,...s("sleepMs",{required:"sleepMs is required (0 is ok)",min:{value:0,message:"sleepMs must be positive"},max:{value:6e4,message:"sleepMs must be ≤ 60000"}})}),e.jsx(c.Control.Feedback,{type:"invalid",children:m.sleepMs?.message})]}),e.jsx(T,{type:"submit","data-testid":"TestJobForm-Submit-Button",children:"Submit"})]})}q.__docgenInfo={description:"",methods:[],displayName:"TestJobForm"};function I({commons:t,handleCommonsSelection:o,selectedCommons:s,testid:m="CommonsSelect"}){return e.jsxs(c.Group,{className:"mb-3",children:[e.jsx(c.Text,{htmlFor:"commons",className:"fw-bold fs-5",children:"Commons"}),e.jsx("div",{className:"ms-3","data-testid":`${m}-CommonsSelect-div`,children:t.map(n=>e.jsx(c.Check,{type:"radio",label:n.name,"data-testid":`${m}-commons-${n.id}`,onChange:()=>o(n.id,n.name),checked:s===n.id},n.id))})]})}I.__docgenInfo={description:"",methods:[],displayName:"CommonsSelect",props:{testid:{defaultValue:{value:'"CommonsSelect"',computed:!1},required:!1}}};function G({submitAction:t,testid:o="UpdateCowHealthForm"}){const{data:s}=M(["/api/commons/all"],{url:"/api/commons/all"},[]),n=[{id:0,name:"All Commons"},...s],[a,l]=i.useState(null),[d,u]=i.useState(null),{handleSubmit:p}=A(),h=(C,j)=>{l(C),u(j)},b=()=>{t({selectedCommons:a,selectedCommonsName:d})};return a===null&&(l(n[0].id),u(n[0].name)),e.jsxs(c,{onSubmit:p(b),children:[e.jsx(c.Group,{className:"mb-3",children:e.jsx(c.Text,{htmlFor:"description",children:"Updated the cows' health in a single or all commons."})}),e.jsx(I,{commons:n,selectedCommons:a,handleCommonsSelection:h,testid:o}),e.jsx(T,{type:"submit","data-testid":"UpdateCowHealthForm-Submit-Button",children:"Update"})]})}G.__docgenInfo={description:"",methods:[],displayName:"UpdateCowHealthForm",props:{testid:{defaultValue:{value:'"UpdateCowHealthForm"',computed:!1},required:!1}}};function L({submitAction:t,testid:o="MilkTheCowsForm"}){const{data:s}=M(["/api/commons/all"],{url:"/api/commons/all"},[]),n=[{id:0,name:"All Commons"},...s],[a,l]=i.useState(null),[d,u]=i.useState(null),{handleSubmit:p}=A(),h=(C,j)=>{l(C),u(j)},b=()=>{t({selectedCommons:a,selectedCommonsName:d})};return a===null&&(l(n[0].id),u(n[0].name)),e.jsxs(c,{onSubmit:p(b),children:[e.jsx(c.Group,{className:"mb-3",children:e.jsx(c.Text,{htmlFor:"description",children:"Milk the cows in a single or all commons."})}),e.jsx(I,{commons:n,selectedCommons:a,handleCommonsSelection:h,testid:o}),e.jsx(T,{type:"submit","data-testid":"MilkTheCowsForm-Submit-Button",children:"Milk the cows!"})]})}L.__docgenInfo={description:"",methods:[],displayName:"MilkTheCowsForm",props:{testid:{defaultValue:{value:'"MilkTheCowsForm"',computed:!1},required:!1}}};function D({submitAction:t}){const{handleSubmit:o}=A();return e.jsxs(c,{onSubmit:o(t),children:[e.jsx("p",{children:"Click this button to generate an instructor report!"}),e.jsx(T,{type:"submit","data-testid":"InstructorReport-Submit-Button",children:"Generate"})]})}D.__docgenInfo={description:"",methods:[],displayName:"InstructorReportForm"};function K({submitAction:t}){const o="InstructorReportSpecificCommonsForm",{data:s}=M(["/api/commons/all"],{url:"/api/commons/all"},[]),[m,n]=i.useState(null),[a,l]=i.useState(null),{handleSubmit:d,formState:{_errors:u}}=A(),p=(b,C)=>{n(b),l(C)},h=()=>{t({selectedCommons:m,selectedCommonsName:a})};return!s||s.length===0?e.jsx("div",{children:"There are no commons on which to run this job."}):(m===null&&(n(s[0].id),l(s[0].name)),e.jsxs(c,{onSubmit:d(h),children:[e.jsx(I,{commons:s,selectedCommons:m,handleCommonsSelection:p,testid:o}),e.jsx("p",{children:"Click this button to generate an instructor report for the selected commons."}),e.jsx(T,{type:"submit","data-testid":"InstructorReportSpecificCommonsForm-Submit-Button",children:"Generate"})]}))}K.__docgenInfo={description:"",methods:[],displayName:"InstructorReportSpecificCommonsForm"};function z({submitAction:t=()=>{},testid:o="SetCowHealthForm"}){const s=localStorage.getItem(`${o}-health`),[m,n]=i.useState(s||100),{data:a}=M(["/api/commons/all"],{url:"/api/commons/all"},[]),[l,d]=i.useState(null),[u,p]=i.useState(null),{handleSubmit:h,register:b,formState:{errors:C}}=A(),j=g=>{const x=g.target.value;n(x),localStorage.setItem(`${o}-health`,x)},v=(g,x)=>{d(g),p(x)},k=()=>{t({selectedCommons:l,healthValue:m,selectedCommonsName:u})};return!a||a.length===0?e.jsx("div",{children:"There are no commons on which to run this job."}):(l===null&&(d(a[0].id),p(a[0].name)),e.jsxs(c,{onSubmit:h(k),children:[e.jsx(c.Group,{className:"mb-3",children:e.jsx(c.Text,{htmlFor:"description",children:"Set the cow health for all cows in a single commons."})}),e.jsx(I,{commons:a,selectedCommons:l,handleCommonsSelection:v,testid:o}),e.jsxs(c.Group,{className:"mb-3",children:[e.jsx(c.Label,{htmlFor:"healthValue",children:"Health [0-100]"}),e.jsx(c.Control,{"data-testid":`${o}-healthValue`,id:"healthValue",type:"number",step:"1",value:m,...b("healthValue",{valueAsNumber:!0,required:"Health Value is required",min:{value:0,message:"Health Value must be ≥ 0"},max:{value:100,message:"Health Value must be ≤ 100"}}),onChange:j}),e.jsx(c.Control.Feedback,{type:"invalid",children:C.healthValue?.message})]}),e.jsx(T,{type:"submit","data-testid":"SetCowHealthForm-Submit-Button",children:"Set Cow Health"})]}))}z.__docgenInfo={description:"",methods:[],displayName:"SetCowHealthForm",props:{submitAction:{defaultValue:{value:"()=>{}",computed:!1},required:!1},testid:{defaultValue:{value:'"SetCowHealthForm"',computed:!1},required:!1}}};const V=()=>{const o=f(r=>({url:`/api/jobs/launch/testjob?fail=${r.fail}&sleepMs=${r.sleepMs}`,method:"POST"}),{},["/api/jobs/all"]),s=async r=>{S("Submitted job: Test Job"),o.mutate(r)},n=f(r=>({url:`/api/jobs/launch/setcowhealth?commonsID=${r.selectedCommons}&health=${r.healthValue}`,method:"POST"}),{},["/api/jobs/all"]),a=async r=>{S(`Submitted Job: Set Cow Health (Commons: ${r.selectedCommonsName}, Health: ${r.healthValue})`),n.mutate(r)},l=()=>({url:"/api/jobs/launch/updatecowhealth",method:"POST"}),d=r=>({url:`/api/jobs/launch/updatecowhealthsinglecommons?commonsId=${r.selectedCommons}`,method:"POST"}),u=f(l,{},["/api/jobs/all"]),p=f(d,{},["/api/jobs/all"]),h=async r=>{r.selectedCommonsName==="All Commons"?(S("Submitted Job: Update Cow Health"),u.mutate()):(S(`Submitted Job: Update Cow Health (Commons: ${r.selectedCommonsName})`),p.mutate(r))},b=()=>({url:"/api/jobs/launch/milkthecowjob",method:"POST"}),C=r=>({url:`/api/jobs/launch/milkthecowjobsinglecommons?commonsId=${r.selectedCommons}`,method:"POST"}),j=f(b,{},["/api/jobs/all"]),v=f(C,{},["/api/jobs/all"]),k=async r=>{r.selectedCommonsName==="All Commons"?(S("Submitted Job: Milk The Cows!"),j.mutate()):(S(`Submitted Job: Milk The Cows! (Commons: ${r.selectedCommonsName})`),v.mutate(r))},x=f(()=>({url:"/api/jobs/launch/instructorreport",method:"POST"}),{},["/api/jobs/all"]),Q=async()=>{S("Submitted Job: Instructor Report"),x.mutate()},W=f(r=>({url:`/api/jobs/launch/instructorreportsinglecommons?commonsId=${r.selectedCommons}`,method:"POST"}),{},["/api/jobs/all"]),X=async r=>{S("Submitted Job: Instructor Report (Specific Commons)"),W.mutate(r)},Y=[{name:"Test Job",form:e.jsx(q,{submitAction:s})},{name:"Set Cow Health for a Specific Commons",form:e.jsx(z,{submitAction:a})},{name:"Update Cow Health",form:e.jsx(G,{submitAction:h})},{name:"Milk The Cows",form:e.jsx(L,{submitAction:k})},{name:"Instructor Report",form:e.jsx(D,{submitAction:Q})},{name:"Instructor Report (for specific commons)",form:e.jsx(K,{submitAction:X})}];return e.jsxs(Z,{children:[e.jsx("h2",{className:"p-3",children:"Launch Jobs"}),e.jsx(J,{children:Y.map((r,$)=>e.jsxs(J.Item,{eventKey:$,children:[e.jsx(J.Header,{children:r.name}),e.jsx(J.Body,{children:r.form})]},$))}),e.jsx("h2",{className:"p-3",children:"Job Status"}),e.jsx(ee,{})]})};V.__docgenInfo={description:"",methods:[],displayName:"AdminJobsPage"};const ke={title:"pages/AdminJobsPage",component:V},ne=()=>e.jsx(V,{}),F=ne.bind({});F.parameters={...F.parameters,docs:{...F.parameters?.docs,source:{originalSource:"() => <AdminJobsPage />",...F.parameters?.docs?.source}}};const Pe=["Default"];export{F as Default,Pe as __namedExportsOrder,ke as default};
