import{j as e}from"./jsx-runtime-BC85tlZo.js";import{r as l}from"./iframe-BTuJcAs9.js";import{B as d}from"./Button-BDV_ecRq.js";import{M as o}from"./Modal-Xy1HWVR7.js";import{O as H,B as n,H as p}from"./OurTable-DtSV993S.js";import{u as B}from"./useBackend-CbiZWCPX.js";import{o as S,c as k}from"./commonsUtils-BXVpWSbP.js";import{h as C}from"./currentUser-Beivyx2b.js";import{u as M}from"./index-BB7RSFYR.js";function L({commons:h,currentUser:c}){const[u,t]=l.useState(!1),[x,g]=l.useState(null),i=M(),f=a=>{i(`/admin/editcommons/${a.row.values["commons.id"]}`)},w=B(k,{onSuccess:S},["/api/commons/allplus"]),j=async a=>{g(a),t(!0)},y=async a=>{w.mutate(a),t(!1)},D=a=>{const r=`/leaderboard/${a.row.values["commons.id"]}`;i(r)},m=[{Header:"id",accessor:"commons.id"},{Header:"Name",accessor:"commons.name"},{Header:e.jsxs("span",{children:["Cow",e.jsx("br",{})," Price"]}),accessor:a=>a.commons.cowPrice,id:"commons.cowPrice"},{Header:e.jsxs("span",{children:[" Milk ",e.jsx("br",{})," Price "]}),accessor:a=>a.commons.milkPrice,id:"commons.milkPrice"},{Header:e.jsxs("span",{children:[" Start ",e.jsx("br",{})," Bal "]}),accessor:a=>a.commons.startingBalance,id:"commons.startingBalance"},{Header:e.jsxs("span",{children:[" Starting ",e.jsx("br",{})," Date "]}),accessor:a=>String(a.commons.startingDate).slice(0,10),id:"commons.startingDate"},{Header:e.jsxs("span",{children:[" Last ",e.jsx("br",{})," Date "]}),accessor:a=>String(a.commons.lastDate).slice(0,10),id:"commons.lastDate"},{Header:e.jsxs("span",{children:[" Degrad ",e.jsx("br",{})," Rate "]}),accessor:a=>a.commons.degradationRate,id:"commons.degradationRate"},{Header:e.jsxs("span",{children:[" Show ",e.jsx("br",{})," LrdrBrd? "]}),id:"commons.showLeaderboard",accessor:(a,r)=>String(a.commons.showLeaderboard)},{Header:e.jsxs("span",{children:[" Show ",e.jsx("br",{})," Chat? "]}),id:"commons.showChat",accessor:(a,r)=>String(a.commons.showChat)},{Header:e.jsxs("span",{children:[" Tot ",e.jsx("br",{})," Cows "]}),accessor:"totalCows"},{Header:e.jsxs("span",{children:[" Cap / ",e.jsx("br",{})," User "]}),accessor:a=>a.commons.capacityPerUser,id:"commons.capacityPerUser"},{Header:e.jsxs("span",{children:[" Carry ",e.jsx("br",{})," Cap "]}),accessor:a=>a.commons.carryingCapacity,id:"commons.carryingCapacity"},{Header:e.jsxs("span",{children:[" Eff ",e.jsx("br",{})," Cap "]}),accessor:"effectiveCapacity"}],s="CommonsTable",b=[...m,n("Edit","primary",f,s),n("Delete","danger",j,s),n("Leaderboard","secondary",D,s),p("Stats CSV","success","/api/commonstats/download?commonsId=",s),p("Announcements","info","/admin/announcements/",s)],P=C(c,"ROLE_ADMIN")?b:m,T=e.jsxs(o,{"data-testid":"CommonsTable-Modal",show:u,onHide:()=>t(!1),children:[e.jsx(o.Header,{closeButton:!0,children:e.jsx(o.Title,{children:"Confirm Deletion"})}),e.jsx(o.Body,{children:"Are you sure you want to delete this commons?"}),e.jsxs(o.Footer,{children:[e.jsx(d,{variant:"secondary","data-testid":"CommonsTable-Modal-Cancel",onClick:()=>t(!1),children:"Keep this Commons"}),e.jsx(d,{variant:"danger","data-testid":"CommonsTable-Modal-Delete",onClick:()=>y(x),children:"Permanently Delete"})]})]});return e.jsxs(e.Fragment,{children:[e.jsx(H,{data:h,columns:P,testid:s}),C(c,"ROLE_ADMIN")&&T]})}L.__docgenInfo={description:"",methods:[],displayName:"CommonsTable"};const F={threeCommonsPlus:[{commons:{id:1,name:"com",cowPrice:1,milkPrice:1,startingBalance:10,startingDate:"2022-11-22T21:23:45",lastDate:"2022-11-22T21:23:45",endingDate:null,degradationRate:.01,showLeaderboard:!1,showChat:!1,capacityPerUser:50,carryingCapacity:100},totalCows:10,totalUsers:2,effectiveCapacity:100},{commons:{id:2,name:"Com2",cowPrice:1,milkPrice:2,startingBalance:10,startingDate:"2022-11-22T12:34:56",lastDate:"2022-11-22T12:34:56",endingDate:null,degradationRate:.01,showLeaderboard:!0,showChat:!0,capacityPerUser:5,carryingCapacity:42},totalCows:0,totalUsers:1,effectiveCapacity:42},{commons:{id:3,name:"Not DLG",cowPrice:10,milkPrice:3,startingBalance:74,startingDate:"2022-11-26T00:00:00",lastDate:"2022-11-26T00:00:00",endingDate:null,degradationRate:5,showLeaderboard:!0,showChat:!0,capacityPerUser:50,carryingCapacity:123},totalCows:0,totalUsers:1,effectiveCapacity:123}],oneCommonsPlus:[{commons:{id:4,name:"Test",cowPrice:10,milkPrice:1,startingBalance:100,startingDate:"2022-11-11T00:00:00",lastDate:"2022-11-11T00:00:00",endingDate:null,degradationRate:3,showLeaderboard:!1,showChat:!1,capacityPerUser:1,carryingCapacity:23},totalCows:0,totalUsers:0,effectiveCapacity:23}]};export{L as C,F as c};
